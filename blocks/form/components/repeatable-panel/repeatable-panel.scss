@use '../../../../styles/settings' as *;

.form dialog {
  width: 100%;
  max-width: 744px;
  border: none;
  border-radius: $border-radius-mid;
  padding: 0;
  position: relative;

  .modal-content {
    background-color: $color-shade-blue-04;

    > legend {
      @include heading-level-4;
      padding: $spacing-450;
      color: $color-primary-navy;
      font-weight: 700;
      border-bottom: 2px solid $color-shade-navy-20;
      background-color: $color-white;
    }

    .plain-text-wrapper {
      padding: $spacing-450;

      * { font-size: $size-font-body-large; }
    }

    .field-buttons-wrapper {
      background-color: $color-white;
      border-top: 2px solid $color-shade-navy-20;
      padding: $spacing-450;
      display: flex;
      justify-content: space-between;
    }
  }

  .close-button {
    right: $spacing-500;
    top: $spacing-500;
    position: absolute;
    height: 20px;
    width: 20px;
    background-image: url('/icons/icon-x-dark.svg');
    background-size: contain;
    background-position: center;
  }

  fieldset[name='buttons-wrapper'] {
    display: flex;

    button {
      @extend %button;

      &[name='btnYes'],
      &[name='btnNo'] { @include elevation-1; }

      &[name='btnNo'] { @extend %button--primary; }
      &[name='btnYes'] { @extend %button--hollow; }
    }
  }
}

.form .repeat-wrapper.panel-repeatable-panel {
  &[data-max='1'] button.item-add { display: none; }

  > fieldset[data-index='0']{
    .first-entry-title { display: block; }
    .additional-entries-title { display: none; }
  }

  > fieldset:not([data-index='0']){
    .first-entry-title { display: none; }
    .additional-entries-title { display: block; }
  }

  .repeatable-entries {
    .repeatable-entry {
      padding: $spacing-400 $spacing-900 $spacing-400 $spacing-400;
      border-radius: 8px;

      /* Borders and background */
      border-top: 8px solid $color-shade-blue-40;
      border-right: 2px solid $color-shade-blue-40;
      border-bottom: 2px solid $color-shade-blue-40;
      border-left: 2px solid $color-shade-blue-40;
      background: $bg-light-primary;

      /* Shadow */
      box-shadow: 0px 4px 8px 0px rgba(22, 44, 69, 0.18);
      position: relative;
      margin-bottom: $spacing-600;

      &__language,
      .repeatable-entry__cardTitle,
      .repeatable-entry__course,
      .repeatable-entry__title {
        color: $color-primary-navy;
        font-feature-settings: 'liga' off, 'clig' off;
        font-size: $size-font-h6;
        font-style: normal;
        font-weight: $font-weight-bold;
        line-height: 130%;
        letter-spacing: $letter-spacing-default;
      }

      &__proficiency {
        color: $text-primary;
        font-size: $size-font-body-default;
        font-style: normal;
        font-weight: $font-weight-regular;
        line-height: 160%;
        letter-spacing: $letter-spacing-default;
      }

      &__delete {
        position: absolute;
        top: ($spacing-400 * 2 + 26px);
        right: $spacing-400;
        width: 56px;
        height: 26px;
        background-repeat: no-repeat;
        display: block;
        text-decoration: underline;
        padding-left: 28px;
        font-size: $size-font-body-default;
        font-style: normal;
        font-weight: $font-weight-medium;
        line-height: 133%;
        letter-spacing: $letter-spacing-default;
        color: $text-accent;

        &:hover,
        &:focus,
        &:visited { color: $text-dark; }
      }
    }
  }

  .repeatable-entry__edit {
    position: absolute;
    top: $spacing-400;
    right: $spacing-400;
    width: 56px;
    height: 26px;
    background-image: url('./images/icon-repeatable-panel-edit-blue.svg');
    background-repeat: no-repeat;
    display: block;
    text-align: center;
    padding-left: 28px;
    text-decoration: underline;
    font-size: $size-font-body-default;
    font-style: normal;
    font-weight: $font-weight-medium;
    line-height: 133%;
    letter-spacing: $letter-spacing-default;
    color: $text-accent;

    &:hover,
    &:focus,
    &:visited { color: $text-dark; }
  }

  &__conditional { display: none; }

  /* Global spacing between visible fields */
  .field-wrapper:not([data-visible='false']) {
    color: $text-primary;

    + .field-wrapper {
      margin-top: $spacing-600;
    }
  }

  /* =========================================
     EXCLUSIONS for adjacent spacing:
     - Standalone Start Year dropdown (.field-start-year)
     - Advanced datepicker Month/Year (.field-start-month / .field-start-year)
     - Start of work Month/Year (.field-startofwork-month / .field-startofwork-year)
     - Also remove spacing within either panel wrapper to keep Month/Year inline
  ========================================= */
  .field-wrapper:not([data-visible='false']) + .field-wrapper.field-start-year,
  .field-wrapper:not([data-visible='false']) + .field-wrapper.field-start-month,
  .field-wrapper:not([data-visible='false']) + .field-wrapper.field-startofwork-month,
  .field-wrapper:not([data-visible='false']) + .field-wrapper.field-startofwork-year {
    margin-top: 0;
  }

  .panel-wrapper.field-advanceddatepicker .field-wrapper:not([data-visible='false']) + .field-wrapper,
  .panel-wrapper.field-startofwork       .field-wrapper:not([data-visible='false']) + .field-wrapper {
    margin-top: 0;
  }

  /* Optional exact-target overrides by data-id (keep if needed)
  .field-wrapper:not([data-visible='false']) + .field-wrapper[data-id='dropdown-30fbfa8192'], // Start Year
  .field-wrapper:not([data-visible='false']) + .field-wrapper[data-id='dropdown-9374462f1a'], // Advanced datepicker - Month
  .field-wrapper:not([data-visible='false']) + .field-wrapper[data-id='dropdown-4734d75674'], // Start of work - Year
  .field-wrapper:not([data-visible='false']) + .field-wrapper[data-id='dropdown-ea0d045f7b']  // Start of work - Month
  { margin-top: 0; }
  */

  /* Explicit top margin for multiline blocks (if present) */
  .multiline-wrapper,
  .field-wrapper.multiline-wrapper { margin-top: 2rem; }

  &[data-variant='addRemoveButtons'] .item-remove {
    @extend %button;
    @extend %button--primary;
    display: none !important;
    margin-top: 21px;
  }

  .item-add i {
    display: inline-block;
    width: 16px;
    height: 16px;
    background-image: url('images/icon-repeatable-panel-plus-blue.svg');
    background-size: contain;
    background-repeat: no-repeat;
    margin-right: 8px;
    vertical-align: middle;
  }

  &.editing {
    .item-add,
    .repeatable-entry__edit,
    .repeatable-entry__delete { display: none; }
  }

  [data-repeatable] {
    display: none;

    .btn-delete {
      @extend %button;
      @extend %button--hollow;
      display: none;
    }

    &.saved { .btn-delete { display: block; } }

    .button-bar {
      display: flex;
      gap: 20px;
      margin-top: 65px;

      .btn-save   { @extend %button; @extend %button--primary; }
      .btn-cancel { @extend %button; @extend %button--hollow;  }

      .btn-save,
      .btn-cancel { @include elevation-1; }
    }

    &.current { display: block; }
  }
}

/* ---------------------------------------------------------
   Start-of-work panel: align select chevrons (Month/Year)
   Scoped so the first advanced datepicker remains unchanged
--------------------------------------------------------- */
.form .repeat-wrapper.panel-repeatable-panel
.panel-wrapper.field-startofwork .field-wrapper select {
  -webkit-appearance: none;
  appearance: none;
  box-sizing: border-box;

  /* keep space for the chevron and center contents */
  padding-right: $spacing-700;
  padding-block: $spacing-300;

  /* position the background chevron in the vertical middle */
  background-repeat: no-repeat;
  background-origin: content-box;
  background-position: right $spacing-350 center !important;
  background-size: 1rem auto; /* tweak if your icon size differs */
}

/* Hide IEâ€™s native dropdown arrow if any legacy styles apply */
.form .repeat-wrapper.panel-repeatable-panel
.panel-wrapper.field-startofwork .field-wrapper select::-ms-expand {
  display: none;
}
